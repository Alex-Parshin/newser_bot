/*
 Copyright (c) 2017-2019 Cliqz GmbH. All rights reserved.

 This Source Code Form is subject to the terms of the Mozilla Public
 License, v. 2.0. If a copy of the MPL was not distributed with this
 file, You can obtain one at https://mozilla.org/MPL/2.0/.
*/
'use strict';(function(b,g){"object"===typeof exports&&"undefined"!==typeof module?g(exports):"function"===typeof define&&define.amd?define(["exports"],g):(b="undefined"!==typeof globalThis?globalThis:b||self,g(b.adblocker={}))})(this,function(b){function g(a){let c=[];for(let b=0;b<a.length;b+=1){var d=a[b];if("attributes"===d.type)c.push(d.target);else if("childList"===d.type){d=d.addedNodes;for(let a=0;a<d.length;a+=1){var h=d[a];c.push(h);if(void 0!==h.querySelectorAll){h=h.querySelectorAll("[id],[class],[href]");
for(let a=0;a<h.length;a+=1)c.push(h[a])}}}}return c}function l(a){let c=new Set("br head link meta script style".split(" ")),d=new Set,h=new Set,b=new Set;for(let k=0;k<a.length;k+=1){var e=a[k];if(1===e.nodeType&&(void 0===e.localName||!c.has(e.localName))){var f=e.id;f&&b.add(f);if(f=e.classList)for(let a=0;a<f.length;a+=1)d.add(f[a]);e=e.href;"string"===typeof e&&h.add(e)}}return{classes:Array.from(d),hrefs:Array.from(h),ids:Array.from(b)}}function m(a){return`try{${a}}catch(c){}!function(){var c=document.currentScript,e=c&&c.parentNode;e&&e.removeChild(c)}();`}
class n{constructor(a){this.cb=a;this.knownIds=new Set;this.knownHrefs=new Set;this.knownClasses=new Set;this.observer=null}queryAll(a){this.handleNewNodes(Array.from(a.document.querySelectorAll("[id],[class],[href]")))}start(a){null===this.observer&&void 0!==a.MutationObserver&&(this.observer=new a.MutationObserver(a=>{this.handleNewNodes(g(a))}),this.observer.observe(a.document.documentElement,{attributeFilter:["class","id","href"],attributes:!0,childList:!0,subtree:!0}))}stop(){null!==this.observer&&
(this.observer.disconnect(),this.observer=null)}handleNewFeatures({hrefs:a,ids:c,classes:d}){let b=[],g=[],e=[];for(var f=0;f<c.length;f+=1){let a=c[f];!1===this.knownIds.has(a)&&(b.push(a),this.knownIds.add(a))}for(c=0;c<d.length;c+=1)f=d[c],!1===this.knownClasses.has(f)&&(g.push(f),this.knownClasses.add(f));for(d=0;d<a.length;d+=1)c=a[d],!1===this.knownHrefs.has(c)&&(e.push(c),this.knownHrefs.add(c));return 0!==b.length||0!==g.length||0!==e.length?(this.cb({classes:g,hrefs:e,ids:b}),!0):!1}handleNewNodes(a){return this.handleNewFeatures(l(a))}}
b.DOMMonitor=n;b.autoRemoveScript=m;b.extractFeaturesFromDOM=l;b.getDOMElementsFromMutations=g;b.injectCSSRule=function(a,c){let d=c.head||c.getElementsByTagName("head")[0]||c.documentElement;if(null!==d){let b=c.createElement("style");b.type="text/css";b.id="cliqz-adblokcer-css-rules";b.appendChild(c.createTextNode(a));d.appendChild(b)}};b.injectScript=function(a,c){let b=c.createElement("script");b.type="text/javascript";b.id="cliqz-adblocker-script";b.async=!1;b.appendChild(c.createTextNode(m(a)));
a=c.head||c.documentElement;null!==a&&a.appendChild(b)};Object.defineProperty(b,"__esModule",{value:!0})})
//# sourceMappingURL=adblocker.umd.min.js.map
